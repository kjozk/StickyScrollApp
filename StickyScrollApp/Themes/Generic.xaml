<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:local="clr-namespace:StickyScrollApp"
                    xmlns:vm="clr-namespace:StickyScrollApp.ViewModels"
                    xmlns:controls="clr-namespace:StickyScrollApp.Controls">

  <Style TargetType="{x:Type controls:StickyTreeView}">
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type controls:StickyTreeView}">
          <Grid>
            <ScrollViewer x:Name="PART_ScrollViewer"
                          Grid.Row="1"
                          CanContentScroll="False"
                          HorizontalScrollBarVisibility="{TemplateBinding ScrollViewer.HorizontalScrollBarVisibility}"
                          VerticalScrollBarVisibility="{TemplateBinding ScrollViewer.VerticalScrollBarVisibility}">
              <ItemsPresenter />
            </ScrollViewer>
            <Border Background="White"
                    VerticalAlignment="Top"
                    Margin="0,0,16,0">
              <StackPanel x:Name="PART_StickyHeaderPanel"/>
            </Border>
          </Grid>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
    <Setter Property="ItemContainerStyle">
      <Setter.Value>
        <Style TargetType="TreeViewItem">
          <Setter Property="IsExpanded" Value="{Binding IsExpanded, Mode=TwoWay}" />
        </Style>
      </Setter.Value>
    </Setter>
  </Style>

  <!-- FolderViewModel用: 階層構造をサポート -->
  <HierarchicalDataTemplate DataType="{x:Type vm:FolderViewModel}" ItemsSource="{Binding Children}">
    <Border Background="LightBlue" 
            BorderBrush="White"
            BorderThickness="1"
            Padding="2" CornerRadius="2" HorizontalAlignment="Left">
      <TextBlock Text="{Binding Name}" />
    </Border>
  </HierarchicalDataTemplate>

  <DataTemplate DataType="{x:Type vm:FileViewModel}">
    <Border Background="LightGreen" 
            BorderBrush="White"
            BorderThickness="1"
            Padding="2" CornerRadius="2" HorizontalAlignment="Left">
      <TextBlock Text="{Binding Name}" />
    </Border>
  </DataTemplate>

</ResourceDictionary>